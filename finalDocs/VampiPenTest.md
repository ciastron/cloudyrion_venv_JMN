# VAMPI PENTEST REPORT

This document provides a report of the vulnerabiilties that we have found on VampI APIs.

## User Enumeration
### Description
The username enumeration is an activity in which an attacker tries to retrieve valid usernames from a web application. The web applications are mostly vulnerable to this type of attack on login pages, registration form pages or password reset pages.

The are several APIs vulnerable to user enumerations in VampI.
- POST /users/v1/register
   - This POST request requires a JSON object as input: {"username": "test1",  "password": "tes1", "email": "test1"}.
   - If the application receives a JSON object with the structure {"username" : "test1"}, it first checks if "test1" is present in the DB, if yes, the application replies back with 200 OK saying that the username is already present in the DB, otherwise (test1 is not present in the DB) the application replies with an error code because the structure of the input is wrong.

### PoF
When sending a POST request, the payload is crafted using BurpSuite and we sent only the username of an existing account.
![user enum 1](img/userEnum1.jpg)

### Mitigation
1. Login Page
  - Make sure to return a generic “No such username or password” message when a login failure occurs.
  - Make sure the HTTP response, and the time taken to respond are no different when a username does not exist, and an incorrect password is entered.
2. Registration Page
  - Avoid having your site tell people that a supplied username is already taken.
  - If your usernames are email addresses, send a password reset email if a user tries to sign-up with an existing address.
  - If usernames are not email addresses, protect your sign-up page with a CAPTCHA.

### Side notes: 
The email field is not checked in the backed, for instance, a wrong email address does not trigger any error in the application.
